{"remainingRequest":"/Users/shaojm/work/www/v4-document/node_modules/babel-loader/lib/index.js??ref--3-1!/Users/shaojm/work/www/v4-document/node_modules/cache-loader/dist/cjs.js??ref--0-0!/Users/shaojm/work/www/v4-document/node_modules/vue-loader/lib/index.js??vue-loader-options!/Users/shaojm/work/www/v4-document/docs/.vuepress/components/Tools/Sign.vue?vue&type=script&lang=js","dependencies":[{"path":"/Users/shaojm/work/www/v4-document/docs/.vuepress/components/Tools/Sign.vue","mtime":1698990381567},{"path":"/Users/shaojm/work/www/v4-document/node_modules/cache-loader/dist/cjs.js","mtime":1698990385840},{"path":"/Users/shaojm/work/www/v4-document/node_modules/babel-loader/lib/index.js","mtime":1698990385643},{"path":"/Users/shaojm/work/www/v4-document/node_modules/cache-loader/dist/cjs.js","mtime":1698990385840},{"path":"/Users/shaojm/work/www/v4-document/node_modules/vue-loader/lib/index.js","mtime":1698990388265}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:aW1wb3J0ICJjb3JlLWpzL21vZHVsZXMvZXMuYXJyYXkucHVzaC5qcyI7CmltcG9ydCAiY29yZS1qcy9tb2R1bGVzL3dlYi51cmwtc2VhcmNoLXBhcmFtcy5kZWxldGUuanMiOwppbXBvcnQgImNvcmUtanMvbW9kdWxlcy93ZWIudXJsLXNlYXJjaC1wYXJhbXMuaGFzLmpzIjsKaW1wb3J0ICJjb3JlLWpzL21vZHVsZXMvd2ViLnVybC1zZWFyY2gtcGFyYW1zLnNpemUuanMiOwppbXBvcnQgc2lnblV0aWwgZnJvbSAiL3V0aWxzL3NpZ25VdGlsIjsKaW1wb3J0IHNoYTI1NiBmcm9tICJjcnlwdG8tanMvc2hhMjU2IjsKZXhwb3J0IGRlZmF1bHQgewogIG5hbWU6ICJzaWduIiwKICBtb3VudGVkKCkgewogICAgaW1wb3J0KCd2dWUtanNvbi1lZGl0b3InKS50aGVuKG1vZHVsZSA9PiB7CiAgICAgIC8vIHVzZSBjb2RlCiAgICAgIHRoaXMuZHluYW1pY0NvbXBvbmVudCA9IG1vZHVsZS5kZWZhdWx0OwogICAgfSk7CiAgfSwKICBkYXRhKCkgewogICAgcmV0dXJuIHsKICAgICAgZHluYW1pY0NvbXBvbmVudDogbnVsbCwKICAgICAgc2lnbkNvbnRlbnQ6ICIiLAogICAgICBzaWduOiAiIiwKICAgICAgaW5wdXREYXRhOiB7CiAgICAgICAgYWNjSWQ6ICIyMDE4MDkyNzE0MzEzMDEwMDE2MjkxIiwKICAgICAgICBzYWx0OiAiRjc4QkM5NkE1NTU0OEIyMzE5RUU2OEUwIiwKICAgICAgICBqc29uRGF0YTogIiIsCiAgICAgICAgc2NvcGU6IFsicmVxdWVzdElkIiwgImFjY0lkIiwgImNsaWVudElkIiwgIm1lcmNoYW50VHJhbnNhY3Rpb25JZCIsICJ0cmFuc2FjdGlvbklkIiwgImFtb3VudCIsICJjYXJkTnVtIiwgImN1cnJlbmN5IiwgInNpZ25UeXBlIl0KICAgICAgfQogICAgfTsKICB9LAogIG1ldGhvZHM6IHsKICAgIHRyaWdnZXJTaWduKCkgewogICAgICBpZiAodGhpcy5pbnB1dERhdGEuanNvbkRhdGEgPT09IHVuZGVmaW5lZCB8fCB0aGlzLmlucHV0RGF0YS5qc29uRGF0YSA9PT0gIiIpIHsKICAgICAgICB0aGlzLiRtZXNzYWdlLmVycm9yKCLor7fovpPlhaXnrb7lkI3lj4LmlbAiKTsKICAgICAgICByZXR1cm47CiAgICAgIH0KICAgICAgaWYgKHRoaXMuaW5wdXREYXRhLmpzb25EYXRhICE9PSB1bmRlZmluZWQgJiYgdGhpcy5pbnB1dERhdGEuanNvbkRhdGEuYWNjSWQgIT09ICIiICYmIHRoaXMuaW5wdXREYXRhLmpzb25EYXRhLmFjY0lkICE9PSB1bmRlZmluZWQpIHsKICAgICAgICB0aGlzLmlucHV0RGF0YS5hY2NJZCA9IHRoaXMuaW5wdXREYXRhLmpzb25EYXRhLmFjY0lkOwogICAgICB9CiAgICAgIHRoaXMuc2lnbkNvbnRlbnQgPSB0aGlzLmdldFNpZ25Db250ZW50KHRoaXMuaW5wdXREYXRhLmpzb25EYXRhKTsKICAgICAgdGhpcy5zaWduID0gdGhpcy5nZXRTaWduKHRoaXMuc2lnbkNvbnRlbnQpOwogICAgfSwKICAgIGdldFNpZ24oc2lnbkNvbnRlbnQpIHsKICAgICAgbGV0IHNpZ24gPSBzaGEyNTYoc2lnbkNvbnRlbnQpOwogICAgICAvLyBzaWduID0gYmFzZTY0LnN0cmluZ2lmeShzaWduKTsKICAgICAgc2lnbiA9IHNpZ24udG9TdHJpbmcoKTsKICAgICAgc2lnbiA9IHNpZ24udG9VcHBlckNhc2UoKTsKICAgICAgY29uc29sZS5sb2coInNpZ246Iiwgc2lnbik7CiAgICAgIHJldHVybiBzaWduOwogICAgfSwKICAgIGdldFNpZ25Db250ZW50KHJlcXVlc3REYXRhKSB7CiAgICAgIGxldCBzaWduU2NvcGUgPSB0aGlzLmlucHV0RGF0YS5zY29wZTsKICAgICAgbGV0IG5lZWRTaWduS2V5TWFwID0gW107CiAgICAgIGxldCBuZWVkU2lnbk1hcCA9IFtdOwogICAgICBmb3IgKGxldCByZXF1ZXN0RGF0YUtleSBpbiByZXF1ZXN0RGF0YSkgewogICAgICAgIGlmIChzaWduU2NvcGUuaW5jbHVkZXMocmVxdWVzdERhdGFLZXkpKSB7CiAgICAgICAgICBuZWVkU2lnbktleU1hcC5wdXNoKHJlcXVlc3REYXRhS2V5KTsKICAgICAgICB9CiAgICAgIH0KICAgICAgbmVlZFNpZ25LZXlNYXAgPSBuZWVkU2lnbktleU1hcC5zb3J0KCk7CiAgICAgIG5lZWRTaWduS2V5TWFwLmZvckVhY2goa2V5ID0+IHsKICAgICAgICBuZWVkU2lnbk1hcFtrZXldID0gcmVxdWVzdERhdGFba2V5XTsKICAgICAgfSk7CiAgICAgIGNvbnNvbGUubG9nKCJjdXJyZW50IHJlcXVlc3QgZGF0YToiLCByZXF1ZXN0RGF0YSk7CiAgICAgIGNvbnNvbGUubG9nKCJLZXkgdmFsdWUgcGFpcnMgd2l0aGluIHRoZSBzaWduYXR1cmUgcmFuZ2XvvJoiLCBuZWVkU2lnbk1hcCk7CiAgICAgIGxldCBPU2lnbkNvbnRlbnQgPSBuZXcgVVJMU2VhcmNoUGFyYW1zKCk7CiAgICAgIG5lZWRTaWduS2V5TWFwLmZvckVhY2goZnVuY3Rpb24gKGtleSwgaWR4LCBhcnJheSkgewogICAgICAgIE9TaWduQ29udGVudC5hcHBlbmQoa2V5LCBuZWVkU2lnbk1hcFtrZXldKTsKICAgICAgfSk7CiAgICAgIGxldCBzaWduQ29udGVudCA9IE9TaWduQ29udGVudC50b1N0cmluZygpOwogICAgICBzaWduQ29udGVudCA9IHRoaXMuaW5wdXREYXRhLnNhbHQgKyBzaWduQ29udGVudDsKICAgICAgY29uc29sZS5sb2coInNpZ25Db250ZW50OiIsIHNpZ25Db250ZW50KTsKICAgICAgcmV0dXJuIHNpZ25Db250ZW50OwogICAgfQogIH0KfTs="},{"version":3,"names":["signUtil","sha256","name","mounted","then","module","dynamicComponent","default","data","signContent","sign","inputData","accId","salt","jsonData","scope","methods","triggerSign","undefined","$message","error","getSignContent","getSign","toString","toUpperCase","console","log","requestData","signScope","needSignKeyMap","needSignMap","requestDataKey","includes","push","sort","forEach","key","OSignContent","URLSearchParams","idx","array","append"],"sources":["docs/.vuepress/components/Tools/Sign.vue"],"sourcesContent":["<template>\n<div>\n  <el-form :inline=\"false\" :model=\"inputData\"  label-width=\"120px\" label-suffix=\":\">\n    <el-form-item label=\"accId\">\n      <el-input v-model=\"inputData.accId\" placeholder=\"请输入accId\"></el-input>\n    </el-form-item>\n    <el-form-item label=\"秘钥\">\n      <el-input v-model=\"inputData.salt\" placeholder=\"请输入salt\"></el-input>\n    </el-form-item>\n    <el-form-item label=\"签名范围\">\n      <component v-if=\"dynamicComponent\"\n                 :is=\"dynamicComponent\"\n                 v-model=\"inputData.scope\"\n                 mode=\"code\"\n                 lang=\"zh\"\n      ></component>\n    </el-form-item>\n    <el-form-item label=\"签名参数\">\n      <component\n          v-if=\"dynamicComponent\"\n          :is=\"dynamicComponent\"\n          v-model=\"inputData.jsonData\"\n          mode=\"code\"\n          lang=\"zh\"\n          :expandedOnStart=\"true\"\n      ></component>\n    </el-form-item>\n    <el-form-item label=\"签名\">\n      <div>{{sign}}</div>\n    </el-form-item>\n    <el-form-item label=\"签名串\">\n      <div>{{signContent}}</div>\n    </el-form-item>\n  </el-form>\n  <div style=\"display: flex;justify-content: flex-end\">\n    <el-button type=\"primary\" @click=\"triggerSign\">获取签名</el-button>\n  </div>\n</div>\n</template>\n\n<style>\ndiv.jsoneditor-menu a.jsoneditor-poweredBy {\n  font-size: 8pt;\n  position: absolute;\n  right: 0;\n  top: 0;\n  display: none;\n}\n\n.jsoneditor-vue{\n  height: 100%;\n}\n\ntextarea.jsoneditor-text, .ace-jsoneditor {\n  min-height: 200px !important;\n}\n</style>\n\n<script>\nimport signUtil from \"/utils/signUtil\";\nimport sha256 from \"crypto-js/sha256\";\n\nexport default {\n  name: \"sign\",\n  mounted() {\n    import('vue-json-editor').then(module => {\n      // use code\n      this.dynamicComponent = module.default\n    })\n  },\n  data(){\n    return {\n      dynamicComponent: null,\n      signContent: \"\",\n      sign: \"\",\n      inputData:{\n        accId:\"2018092714313010016291\",\n        salt:\"F78BC96A55548B2319EE68E0\",\n        jsonData:\"\",\n        scope:[\"requestId\", \"accId\", \"clientId\", \"merchantTransactionId\", \"transactionId\", \"amount\", \"cardNum\", \"currency\", \"signType\"],\n      }\n    }\n  },\n  methods:{\n    triggerSign(){\n     if (this.inputData.jsonData===undefined||this.inputData.jsonData===\"\"){\n       this.$message.error(\"请输入签名参数\");\n       return;\n     }\n\n      if (this.inputData.jsonData!==undefined&&this.inputData.jsonData.accId!==\"\"&&this.inputData.jsonData.accId!==undefined){\n        this.inputData.accId = this.inputData.jsonData.accId\n      }\n\n      this.signContent =  this.getSignContent(this.inputData.jsonData);\n      this.sign = this.getSign(this.signContent);\n\n    },\n    getSign(signContent){\n      let sign = sha256(signContent);\n      // sign = base64.stringify(sign);\n      sign = sign.toString();\n      sign = sign.toUpperCase();\n      console.log(\"sign:\", sign)\n      return sign;\n    },\n    getSignContent(requestData){\n      let signScope = this.inputData.scope\n      let needSignKeyMap = [];\n      let needSignMap = [];\n      for (let requestDataKey in requestData) {\n        if (signScope.includes(requestDataKey)) {\n          needSignKeyMap.push(requestDataKey);\n        }\n      }\n      needSignKeyMap = needSignKeyMap.sort();\n      needSignKeyMap.forEach((key) => {\n        needSignMap[key] = requestData[key];\n      })\n\n      console.log(\"current request data:\", requestData)\n      console.log(\"Key value pairs within the signature range：\", needSignMap);\n      let OSignContent = new URLSearchParams();\n      needSignKeyMap.forEach(function (key, idx, array) {\n        OSignContent.append(key, needSignMap[key]);\n      });\n      let signContent = OSignContent.toString()\n      signContent = this.inputData.salt + signContent;\n      console.log(\"signContent:\", signContent)\n\n      return signContent;\n    }\n  }\n}\n</script>\n\n<style scoped>\n\n</style>"],"mappings":";;;;AA2DA,OAAAA,QAAA;AACA,OAAAC,MAAA;AAEA;EACAC,IAAA;EACAC,QAAA;IACA,0BAAAC,IAAA,CAAAC,MAAA;MACA;MACA,KAAAC,gBAAA,GAAAD,MAAA,CAAAE,OAAA;IACA;EACA;EACAC,KAAA;IACA;MACAF,gBAAA;MACAG,WAAA;MACAC,IAAA;MACAC,SAAA;QACAC,KAAA;QACAC,IAAA;QACAC,QAAA;QACAC,KAAA;MACA;IACA;EACA;EACAC,OAAA;IACAC,YAAA;MACA,SAAAN,SAAA,CAAAG,QAAA,KAAAI,SAAA,SAAAP,SAAA,CAAAG,QAAA;QACA,KAAAK,QAAA,CAAAC,KAAA;QACA;MACA;MAEA,SAAAT,SAAA,CAAAG,QAAA,KAAAI,SAAA,SAAAP,SAAA,CAAAG,QAAA,CAAAF,KAAA,gBAAAD,SAAA,CAAAG,QAAA,CAAAF,KAAA,KAAAM,SAAA;QACA,KAAAP,SAAA,CAAAC,KAAA,QAAAD,SAAA,CAAAG,QAAA,CAAAF,KAAA;MACA;MAEA,KAAAH,WAAA,QAAAY,cAAA,MAAAV,SAAA,CAAAG,QAAA;MACA,KAAAJ,IAAA,QAAAY,OAAA,MAAAb,WAAA;IAEA;IACAa,QAAAb,WAAA;MACA,IAAAC,IAAA,GAAAT,MAAA,CAAAQ,WAAA;MACA;MACAC,IAAA,GAAAA,IAAA,CAAAa,QAAA;MACAb,IAAA,GAAAA,IAAA,CAAAc,WAAA;MACAC,OAAA,CAAAC,GAAA,UAAAhB,IAAA;MACA,OAAAA,IAAA;IACA;IACAW,eAAAM,WAAA;MACA,IAAAC,SAAA,QAAAjB,SAAA,CAAAI,KAAA;MACA,IAAAc,cAAA;MACA,IAAAC,WAAA;MACA,SAAAC,cAAA,IAAAJ,WAAA;QACA,IAAAC,SAAA,CAAAI,QAAA,CAAAD,cAAA;UACAF,cAAA,CAAAI,IAAA,CAAAF,cAAA;QACA;MACA;MACAF,cAAA,GAAAA,cAAA,CAAAK,IAAA;MACAL,cAAA,CAAAM,OAAA,CAAAC,GAAA;QACAN,WAAA,CAAAM,GAAA,IAAAT,WAAA,CAAAS,GAAA;MACA;MAEAX,OAAA,CAAAC,GAAA,0BAAAC,WAAA;MACAF,OAAA,CAAAC,GAAA,gDAAAI,WAAA;MACA,IAAAO,YAAA,OAAAC,eAAA;MACAT,cAAA,CAAAM,OAAA,WAAAC,GAAA,EAAAG,GAAA,EAAAC,KAAA;QACAH,YAAA,CAAAI,MAAA,CAAAL,GAAA,EAAAN,WAAA,CAAAM,GAAA;MACA;MACA,IAAA3B,WAAA,GAAA4B,YAAA,CAAAd,QAAA;MACAd,WAAA,QAAAE,SAAA,CAAAE,IAAA,GAAAJ,WAAA;MACAgB,OAAA,CAAAC,GAAA,iBAAAjB,WAAA;MAEA,OAAAA,WAAA;IACA;EACA;AACA"}]}