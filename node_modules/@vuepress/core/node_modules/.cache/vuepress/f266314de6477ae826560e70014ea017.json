{"remainingRequest":"/Users/shaojm/work/www/v4-document/node_modules/babel-loader/lib/index.js??ref--3-1!/Users/shaojm/work/www/v4-document/utils/signUtil.js","dependencies":[{"path":"/Users/shaojm/work/www/v4-document/utils/signUtil.js","mtime":1698990881725},{"path":"/Users/shaojm/work/www/v4-document/node_modules/cache-loader/dist/cjs.js","mtime":1698990879045},{"path":"/Users/shaojm/work/www/v4-document/node_modules/babel-loader/lib/index.js","mtime":1698990878835}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:cmVxdWlyZSgiY29yZS1qcy9tb2R1bGVzL2VzLmFycmF5LnB1c2guanMiKTsKcmVxdWlyZSgiY29yZS1qcy9tb2R1bGVzL3dlYi51cmwtc2VhcmNoLXBhcmFtcy5kZWxldGUuanMiKTsKcmVxdWlyZSgiY29yZS1qcy9tb2R1bGVzL3dlYi51cmwtc2VhcmNoLXBhcmFtcy5oYXMuanMiKTsKcmVxdWlyZSgiY29yZS1qcy9tb2R1bGVzL3dlYi51cmwtc2VhcmNoLXBhcmFtcy5zaXplLmpzIik7CmNvbnN0IHNoYTI1NiA9IHJlcXVpcmUoJ2NyeXB0by1qcy9zaGEyNTYnKTsKY29uc3Qgc2lnblV0aWwgPSB7CiAgc2lnbjogKHJlcXVlc3REYXRhLCBzYWx0KSA9PiB7CiAgICBsZXQgc2lnblNjb3BlID0gWyJyZXF1ZXN0SWQiLCAiYWNjSWQiLCAiY2xpZW50SWQiLCAibWVyY2hhbnRUcmFuc2FjdGlvbklkIiwgInRyYW5zYWN0aW9uSWQiLCAiYW1vdW50IiwgImNhcmROdW0iLCAiY3VycmVuY3kiLCAic2lnblR5cGUiXTsKICAgIGxldCBuZWVkU2lnbktleU1hcCA9IFtdOwogICAgbGV0IG5lZWRTaWduTWFwID0gW107CiAgICBmb3IgKGxldCByZXF1ZXN0RGF0YUtleSBpbiByZXF1ZXN0RGF0YSkgewogICAgICBpZiAoc2lnblNjb3BlLmluY2x1ZGVzKHJlcXVlc3REYXRhS2V5KSkgewogICAgICAgIG5lZWRTaWduS2V5TWFwLnB1c2gocmVxdWVzdERhdGFLZXkpOwogICAgICB9CiAgICB9CiAgICBuZWVkU2lnbktleU1hcCA9IG5lZWRTaWduS2V5TWFwLnNvcnQoKTsKICAgIG5lZWRTaWduS2V5TWFwLmZvckVhY2goa2V5ID0+IHsKICAgICAgbmVlZFNpZ25NYXBba2V5XSA9IHJlcXVlc3REYXRhW2tleV07CiAgICB9KTsKICAgIGNvbnNvbGUubG9nKCJjdXJyZW50IHJlcXVlc3QgZGF0YToiLCByZXF1ZXN0RGF0YSk7CiAgICBjb25zb2xlLmxvZygiS2V5IHZhbHVlIHBhaXJzIHdpdGhpbiB0aGUgc2lnbmF0dXJlIHJhbmdl77yaIiwgbmVlZFNpZ25NYXApOwogICAgbGV0IE9TaWduQ29udGVudCA9IG5ldyBVUkxTZWFyY2hQYXJhbXMoKTsKICAgIG5lZWRTaWduS2V5TWFwLmZvckVhY2goZnVuY3Rpb24gKGtleSwgaWR4LCBhcnJheSkgewogICAgICBPU2lnbkNvbnRlbnQuYXBwZW5kKGtleSwgbmVlZFNpZ25NYXBba2V5XSk7CiAgICB9KTsKICAgIGxldCBzaWduQ29udGVudCA9IE9TaWduQ29udGVudC50b1N0cmluZygpOwogICAgc2lnbkNvbnRlbnQgPSBzYWx0ICsgc2lnbkNvbnRlbnQ7CiAgICBjb25zb2xlLmxvZygic2lnbkNvbnRlbnQ6Iiwgc2lnbkNvbnRlbnQpOwogICAgbGV0IHNpZ24gPSBzaGEyNTYoc2lnbkNvbnRlbnQpOwogICAgLy8gc2lnbiA9IGJhc2U2NC5zdHJpbmdpZnkoc2lnbik7CiAgICBzaWduID0gc2lnbi50b1N0cmluZygpOwogICAgc2lnbiA9IHNpZ24udG9VcHBlckNhc2UoKTsKICAgIGNvbnNvbGUubG9nKCJzaWduOiIsIHNpZ24pOwogICAgcmVxdWVzdERhdGEuc2lnbiA9IHNpZ247CiAgICByZXR1cm4gc2lnbjsKICB9Cn07Cm1vZHVsZS5leHBvcnRzID0gc2lnblV0aWw7"},{"version":3,"names":["sha256","require","signUtil","sign","requestData","salt","signScope","needSignKeyMap","needSignMap","requestDataKey","includes","push","sort","forEach","key","console","log","OSignContent","URLSearchParams","idx","array","append","signContent","toString","toUpperCase","module","exports"],"sources":["/Users/shaojm/work/www/v4-document/utils/signUtil.js"],"sourcesContent":["const sha256 = require('crypto-js/sha256')\n\nconst signUtil = {\n    sign: (requestData, salt) => {\n        let signScope = [\"requestId\", \"accId\", \"clientId\", \"merchantTransactionId\", \"transactionId\", \"amount\", \"cardNum\", \"currency\", \"signType\"];\n        let needSignKeyMap = [];\n        let needSignMap = [];\n        for (let requestDataKey in requestData) {\n            if (signScope.includes(requestDataKey)) {\n                needSignKeyMap.push(requestDataKey);\n            }\n        }\n        needSignKeyMap = needSignKeyMap.sort();\n        needSignKeyMap.forEach((key) => {\n            needSignMap[key] = requestData[key];\n        })\n        console.log(\"current request data:\", requestData)\n        console.log(\"Key value pairs within the signature rangeï¼š\", needSignMap);\n        let OSignContent = new URLSearchParams();\n        needSignKeyMap.forEach(function (key, idx, array) {\n            OSignContent.append(key, needSignMap[key]);\n        });\n        let signContent = OSignContent.toString()\n        signContent = salt + signContent;\n        console.log(\"signContent:\", signContent)\n        let sign = sha256(signContent);\n        // sign = base64.stringify(sign);\n        sign = sign.toString();\n        sign = sign.toUpperCase();\n        console.log(\"sign:\", sign)\n        requestData.sign = sign;\n        return sign;\n    }\n\n\n}\n\nmodule.exports = signUtil"],"mappings":";;;;AAAA,MAAMA,MAAM,GAAGC,OAAO,CAAC,kBAAkB,CAAC;AAE1C,MAAMC,QAAQ,GAAG;EACbC,IAAI,EAAEA,CAACC,WAAW,EAAEC,IAAI,KAAK;IACzB,IAAIC,SAAS,GAAG,CAAC,WAAW,EAAE,OAAO,EAAE,UAAU,EAAE,uBAAuB,EAAE,eAAe,EAAE,QAAQ,EAAE,SAAS,EAAE,UAAU,EAAE,UAAU,CAAC;IACzI,IAAIC,cAAc,GAAG,EAAE;IACvB,IAAIC,WAAW,GAAG,EAAE;IACpB,KAAK,IAAIC,cAAc,IAAIL,WAAW,EAAE;MACpC,IAAIE,SAAS,CAACI,QAAQ,CAACD,cAAc,CAAC,EAAE;QACpCF,cAAc,CAACI,IAAI,CAACF,cAAc,CAAC;MACvC;IACJ;IACAF,cAAc,GAAGA,cAAc,CAACK,IAAI,CAAC,CAAC;IACtCL,cAAc,CAACM,OAAO,CAAEC,GAAG,IAAK;MAC5BN,WAAW,CAACM,GAAG,CAAC,GAAGV,WAAW,CAACU,GAAG,CAAC;IACvC,CAAC,CAAC;IACFC,OAAO,CAACC,GAAG,CAAC,uBAAuB,EAAEZ,WAAW,CAAC;IACjDW,OAAO,CAACC,GAAG,CAAC,6CAA6C,EAAER,WAAW,CAAC;IACvE,IAAIS,YAAY,GAAG,IAAIC,eAAe,CAAC,CAAC;IACxCX,cAAc,CAACM,OAAO,CAAC,UAAUC,GAAG,EAAEK,GAAG,EAAEC,KAAK,EAAE;MAC9CH,YAAY,CAACI,MAAM,CAACP,GAAG,EAAEN,WAAW,CAACM,GAAG,CAAC,CAAC;IAC9C,CAAC,CAAC;IACF,IAAIQ,WAAW,GAAGL,YAAY,CAACM,QAAQ,CAAC,CAAC;IACzCD,WAAW,GAAGjB,IAAI,GAAGiB,WAAW;IAChCP,OAAO,CAACC,GAAG,CAAC,cAAc,EAAEM,WAAW,CAAC;IACxC,IAAInB,IAAI,GAAGH,MAAM,CAACsB,WAAW,CAAC;IAC9B;IACAnB,IAAI,GAAGA,IAAI,CAACoB,QAAQ,CAAC,CAAC;IACtBpB,IAAI,GAAGA,IAAI,CAACqB,WAAW,CAAC,CAAC;IACzBT,OAAO,CAACC,GAAG,CAAC,OAAO,EAAEb,IAAI,CAAC;IAC1BC,WAAW,CAACD,IAAI,GAAGA,IAAI;IACvB,OAAOA,IAAI;EACf;AAGJ,CAAC;AAEDsB,MAAM,CAACC,OAAO,GAAGxB,QAAQ"}]}